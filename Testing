--// Rayfield Loader
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
    Name = "Mount Atin Hub",
    LoadingTitle = "Mount Atin Hub",
    LoadingSubtitle = "by Yuzii_Kun",
    ConfigurationSaving = {
        Enabled = false
    }
})

--// Variables
local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")

local lp = Players.LocalPlayer
local char, hrp

-- Refresh character (biar setalah mati tetep ke-detect)
local function refreshChar(newChar)
    char = newChar
    hrp = char:WaitForChild("HumanoidRootPart")
end
refreshChar(lp.Character or lp.CharacterAdded:Wait())
lp.CharacterAdded:Connect(refreshChar)

local running = false
local flying = false
local up = 0
local speed = 50

-- Ambil titik teleport dari Pos
local function getTPPoint(posName)
    local obj = workspace:FindFirstChild(posName)
    if obj then
        if obj:IsA("BasePart") then
            return obj.CFrame + Vector3.new(0, 5, 0)
        elseif obj:IsA("Model") then
            local cf, size = obj:GetBoundingBox()
            return cf + Vector3.new(0, 5, 0)
        end
    end
    return nil
end

-- Fly system
local function startFly()
    flying = true
    task.spawn(function()
        while flying do
            task.wait()
            if not hrp then continue end

            hrp.Velocity = Vector3.zero
            hrp.Anchored = false

            local camCF = workspace.CurrentCamera.CFrame
            local moveDir = Vector3.new()

            if UIS:IsKeyDown(Enum.KeyCode.W) then
                moveDir += camCF.LookVector
            end
            if UIS:IsKeyDown(Enum.KeyCode.S) then
                moveDir -= camCF.LookVector
            end
            if UIS:IsKeyDown(Enum.KeyCode.A) then
                moveDir -= camCF.RightVector
            end
            if UIS:IsKeyDown(Enum.KeyCode.D) then
                moveDir += camCF.RightVector
            end
            if up ~= 0 then
                moveDir += Vector3.new(0, up, 0)
            end

            if moveDir.Magnitude > 0 then
                moveDir = moveDir.Unit
                hrp.CFrame = hrp.CFrame + moveDir * speed * task.wait()
            end
        end
    end)
end

local function stopFly()
    flying = false
end

-- Input naik/turun
UIS.InputBegan:Connect(function(input, gp)
    if gp then return end
    if input.KeyCode == Enum.KeyCode.Space then
        up = 1
    elseif input.KeyCode == Enum.KeyCode.LeftShift then
        up = -1
    end
end)

UIS.InputEnded:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.Space or input.KeyCode == Enum.KeyCode.LeftShift then
        up = 0
    end
end)

-- Teleport loop (Start TP All Pos)
local function teleportAll(updateBtn)
    running = true
    startFly()
    updateBtn("Stop TP All Pos")

    local leaderstats = lp:FindFirstChild("leaderstats")
    local startPos = 2
    if leaderstats and leaderstats:FindFirstChild("Pos") then
        local posValue = tonumber(leaderstats.Pos.Value)
        if posValue and posValue >= 2 and posValue < 26 then
            startPos = posValue + 1
        end
    end

    for i = startPos, 26 do
        if not running then break end
        local posName = "Pos"..i
        local point = getTPPoint(posName)
        if point then
            hrp.CFrame = point
            warn("Teleport ke " .. posName)
            task.wait(2)
        else
            warn("Pos " .. posName .. " tidak ditemukan")
        end
    end

    if running then
        local extraCoords = {Vector3.new(803, 2146, 3908)} -- Puncak Gunung
        for _, coord in ipairs(extraCoords) do
            if not running then break end
            hrp.CFrame = CFrame.new(coord)
            warn("Teleport ke koordinat: " .. tostring(coord))
            task.wait(2)
        end
    end

    stopFly()
    running = false
    updateBtn("Start TP All Pos")
end

--// MAIN TAB
local MainTab = Window:CreateTab("Main")

local tpBtn
tpBtn = MainTab:CreateButton({
    Name = "Start TP All Pos",
    Callback = function()
        if running then
            running = false
            stopFly()
            tpBtn:Set("Start TP All Pos")
            warn("Teleport dihentikan manual")
        else
            teleportAll(function(txt) tpBtn:Set(txt) end)
        end
    end,
})

MainTab:CreateButton({
    Name = "Auto Summit",
    Callback = function()
        loadstring(game:HttpGet("https://pastebin.com/raw/HLt50T7x"))()
    end,
})

--// TELEPORT TAB
local TeleportTab = Window:CreateTab("Teleport")

-- Buat tombol Teleport Pos2 - Pos26
for i = 2, 26 do
    TeleportTab:CreateButton({
        Name = "Teleport Pos"..i,
        Callback = function()
            local pos = workspace:FindFirstChild("Pos"..i)
            if pos then
                if pos:IsA("BasePart") then
                    hrp.CFrame = pos.CFrame + Vector3.new(0, 3, 0)
                elseif pos:IsA("Model") then
                    local cf, size = pos:GetBoundingBox()
                    hrp.CFrame = cf + Vector3.new(0, 3, 0)
                end
                warn("Teleport ke Pos"..i)
            else
                warn("Pos"..i.." tidak ditemukan")
            end
        end,
    })
end

-- Tambahan tombol khusus ke Puncak Gunung
TeleportTab:CreateButton({
    Name = "Teleport Puncak Gunung",
    Callback = function()
        hrp.CFrame = CFrame.new(803, 2146, 3908)
        warn("Teleport ke Puncak Gunung")
    end,
})

--// MISC TAB
local MiscTab = Window:CreateTab("Misc")

MiscTab:CreateSlider({
    Name = "WalkSpeed",
    Range = {16, 200},
    Increment = 1,
    Suffix = "Speed",
    CurrentValue = 16,
    Callback = function(val)
        if char and char:FindFirstChildOfClass("Humanoid") then
            char:FindFirstChildOfClass("Humanoid").WalkSpeed = val
        end
    end,
})

MiscTab:CreateToggle({
    Name = "Infinite Jump",
    CurrentValue = false,
    Callback = function(state)
        if state then
            _G.infJump = true
            UIS.JumpRequest:Connect(function()
                if _G.infJump and char and char:FindFirstChildOfClass("Humanoid") then
                    char:FindFirstChildOfClass("Humanoid"):ChangeState("Jumping")
                end
            end)
        else
            _G.infJump = false
        end
    end,
})
